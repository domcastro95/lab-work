# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.181545506001, 0.181545506001,0.181545506001,0.181545506001,0.150732134259,0.0611907085606,0.0416420701057,0.044806799686,0.044806799686,0.044806799686,0.0416420701057,0.0416420701057,0.0416420701057,0.044806799686,0.044806799686,0.0484150282926,0.05558322059,0.067118008268,0.0663277270527,0.0693363268708,0.0839201985138,0.0923110240921,0.0923110240921,0.0940254955701,0.0940254955701,0.0954216336871,0.0940254955701,0.0940254955701,0.0866277462364,0.0911910337848,0.0944983693523,0.11504820039,0.149595211177,0.15226380904,0.137416407333,0.137416407333,0.12318532458,0.115646446635,0.115646446635,0.115646446635,0.106295385908,0.110537880573,0.110537880573,0.115646446635,0.106295385908,0.105909030411,0.105909030411,0.105909030411,0.101660174749,0.0906378128495,0.0879658739899,0.101660174749)
L_hpd_M95=c(0.349276391364, 0.349276391364,0.349276391364,0.349276391364,0.342212860091,0.316477040328,0.227567799992,0.132845175773,0.132845175773,0.132845175773,0.12675430072,0.12675430072,0.12675430072,0.130227636752,0.145421569703,0.151846341323,0.16335550593,0.171132928241,0.171132928241,0.178232490061,0.198675010572,0.198675010572,0.198675010572,0.198675010572,0.198675010572,0.202447365606,0.202447365606,0.202447365606,0.20154063832,0.268117987521,0.367133828384,0.416169435113,0.441791789476,0.441791789476,0.425918164071,0.425918164071,0.409752298202,0.403058862368,0.403058862368,0.409154147531,0.409752298202,0.425918164071,0.425918164071,0.425918164071,0.409752298202,0.403058862368,0.403058862368,0.409752298202,0.432748078708,0.443858356244,0.443858356244,0.462117005784)
M_hpd_m95=c(0.891842068706, 0.891842068706,0.0974562050843,0.0974562050843,0.0974562050843,0.0974562050843,0.0964388767896,0.0964388767896,0.0964388767896,0.0964388767896,0.0970122250842,0.0964388767896,0.0964388767896,0.0947960366121,0.0847819894714,0.081206853899,0.081206853899,0.081206853899,0.081206853899,0.0792620476465,0.081206853899,0.081206853899,0.0769809198134,0.0635495365953,0.0595578251987,0.0594561130304,0.0516471770028,0.0559594435563,0.0482389703674,0.0516471770028,0.0516471770028,0.0516471770028,0.0521283618525,0.0521283618525,0.0482389703674,0.0355423688607,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0244261234739,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014,0.0233714924014)
M_hpd_M95=c(1.50265446044, 1.50265446044,0.152653011093,0.152653011093,0.152653011093,0.152653011093,0.151113060575,0.151113060575,0.151113060575,0.151113060575,0.153160172445,0.153160172445,0.153160172445,0.153160172445,0.143680466012,0.13706452818,0.13706452818,0.13706452818,0.13706452818,0.13706452818,0.13848298791,0.13848298791,0.13848298791,0.137728983216,0.13666263083,0.136545202425,0.125640673618,0.125403246354,0.120465592615,0.125403246354,0.125403246354,0.125403246354,0.125403246354,0.125403246354,0.125403246354,0.125403246354,0.118236237691,0.117474198516,0.11993202334,0.123169103178,0.133764484408,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514,0.134735424514)
R_hpd_m95=c(-1.22462835399, -1.22462835399,0.0440891419341,0.0440891419341,0.0346396738876,-0.0669712068644,-0.0923783145701,-0.0900679596175,-0.0900679596175,-0.0900679596175,-0.0900679596175,-0.081688586635,-0.0830911568609,-0.0900679596175,-0.0776983267333,-0.0729138568252,-0.0617199912411,-0.0451609612047,-0.0492316855071,-0.0430915969983,-0.0451609612047,-0.0196678124739,-0.0196678124739,-0.0196678124739,-0.0194375731859,-0.0100040973159,-0.0100040973159,-0.0110671579374,-0.0110671579374,-0.0161701224157,-0.00232149701075,0.0433002041134,0.0542954652856,0.0596488877601,0.0616285002459,0.0596488877601,0.0575903177662,0.0444058849758,0.0596488877601,0.033993105313,0.0161998760868,0.0191350957848,0.0191350957848,0.0191350957848,0.0161998760868,0.0217774002559,0.0217774002559,0.0217774002559,-0.00962478711417,-0.00962478711417,-0.00962478711417,-0.00962478711417)
R_hpd_M95=c(-0.617001865251, -0.617001865251,0.231163272411,0.231163272411,0.231540112301,0.202414208345,0.0826064278019,0.0167911558325,0.0157575258231,0.0157575258231,0.0180553866375,0.0262812035614,0.0228553806231,0.0206157141311,0.0346396738876,0.0504566807248,0.0579467880923,0.065308280303,0.065308280303,0.0760038532573,0.0803651532329,0.0983225215475,0.0983225215475,0.0983225215475,0.0998436411777,0.114253734522,0.114253734522,0.115823318769,0.124175963538,0.165638845004,0.280979737019,0.337353723877,0.352196125457,0.347456035327,0.352196125457,0.352196125457,0.347456035327,0.347456035327,0.362964541188,0.347456035327,0.347456035327,0.354553612645,0.354553612645,0.354553612645,0.347456035327,0.354553612645,0.354553612645,0.354553612645,0.337121080205,0.354553612645,0.354553612645,0.367558011005)
L_mean=c(0.266745397011, 0.266745397011,0.266745397011,0.266954286674,0.263417446344,0.207037176723,0.0995135540075,0.0903006997588,0.0903006997588,0.0903006997588,0.0897991913433,0.0897399827508,0.0897772029784,0.0899109411542,0.0945336579939,0.0974460669946,0.114079184879,0.12193013622,0.124061791805,0.128499934007,0.138038770081,0.140905787147,0.141518670526,0.141856347196,0.141856347196,0.142516488732,0.143280469461,0.143649292826,0.14460829345,0.154053149459,0.217816436731,0.286905092975,0.293623476065,0.293897737688,0.290391330403,0.289792962579,0.286338566035,0.285107643245,0.284030362284,0.283512509111,0.280836239446,0.281011522307,0.279378394385,0.276859858063,0.272149411535,0.271796678788,0.270249893273,0.267921854109,0.266221461134,0.269173086603,0.269277924747,0.270770984477)
M_mean=c(1.20368715921, 1.20368715921,0.121451286807,0.121451286807,0.121451286807,0.121412038189,0.120937158761,0.120937158761,0.120961673589,0.121017116105,0.120108107607,0.119598008488,0.119090251209,0.118604034106,0.115589193086,0.113397361877,0.112715114435,0.112527144843,0.112374768566,0.113006858755,0.113261729003,0.113177587209,0.111577645997,0.105878276521,0.101052866641,0.096451920781,0.0932132617277,0.0895919694032,0.0878184052668,0.0866676769943,0.0865727422023,0.0865727422023,0.0862938429656,0.0862938429656,0.0848552779852,0.0818767422137,0.0796297528525,0.0793530144555,0.0794585448527,0.0800259956788,0.0818612179036,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529,0.0828616168529)
R_mean=c(-0.936941762199, -0.936941762199,0.145294110204,0.145502999867,0.141966159537,0.0856251385342,-0.0214236047536,-0.0306364590023,-0.0306609738301,-0.0307164163462,-0.0303089162637,-0.0298580257374,-0.0293130482303,-0.0286930929514,-0.0210555350921,-0.0159512948823,0.00136407044411,0.00940299137712,0.0116870232388,0.0154930752522,0.0247770410777,0.0277281999375,0.0299410245299,0.0359780706745,0.0408034805549,0.0460645679514,0.0500672077335,0.0540573234233,0.0567898881833,0.0673854724651,0.131243694529,0.200332350773,0.207329633099,0.207603894722,0.205536052418,0.207916220365,0.206708813182,0.20575462879,0.204571817432,0.203486513432,0.198975021542,0.198149905454,0.196516777532,0.19399824121,0.189287794682,0.188935061935,0.18738827642,0.185060237256,0.183359844282,0.18631146975,0.186416307894,0.187909367624)
trans=0.5
age=(0:(52-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.508328706362), xlim = c(-54.6,2.6), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65291990648), xlim = c(-54.6,2.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.34709118939, 0.404313812106), xlim = c(-54.6,2.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-54.6,2.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()