# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.177632249813, 0.177632249813,0.177632249813,0.177632249813,0.117395584985,0.0687089984261,0.0408486217284,0.042841413705,0.042841413705,0.0408486217284,0.0408486217284,0.0408486217284,0.0408486217284,0.0438569644112,0.0545934823879,0.0545934823879,0.0545934823879,0.0741193806955,0.0827323853301,0.0827323853301,0.0880180820412,0.0909702062224,0.0909702062224,0.0909702062224,0.0909702062224,0.0909702062224,0.0909702062224,0.0891709932842,0.0891709932842,0.0891709932842,0.0973044961215,0.1419255148,0.1419255148,0.1419255148,0.1419255148,0.149208752856,0.149208752856,0.140126985876,0.140126985876,0.140126985876,0.140126985876,0.140126985876,0.140126985876,0.132084048922,0.140126985876,0.123811076292,0.123811076292,0.123811076292,0.123811076292,0.123811076292,0.123811076292,0.123811076292)
L_hpd_M95=c(0.347867295345, 0.347867295345,0.347867295345,0.347867295345,0.347867295345,0.336386073017,0.133557583057,0.131046787782,0.131046787782,0.125478253214,0.125478253214,0.125478253214,0.125478253214,0.133557583057,0.14295427088,0.150835204477,0.162923589108,0.172035336843,0.184189446656,0.184189446656,0.184189446656,0.198569907759,0.198569907759,0.198569907759,0.198569907759,0.198569907759,0.198569907759,0.198569907759,0.200614448047,0.230764101936,0.37375446531,0.454762509168,0.454762509168,0.454762509168,0.449424336988,0.437306032664,0.437306032664,0.429636607024,0.429636607024,0.437306032664,0.437306032664,0.437306032664,0.437306032664,0.437306032664,0.437306032664,0.436945845788,0.436945845788,0.436945845788,0.436945845788,0.436945845788,0.436945845788,0.436945845788)
M_hpd_m95=c(0.896255492678, 0.896255492678,0.0910708261424,0.0910708261424,0.0910708261424,0.0910708261424,0.090401176215,0.090401176215,0.090401176215,0.090401176215,0.090401176215,0.090401176215,0.090401176215,0.090401176215,0.0826342279255,0.0793685810655,0.0793685810655,0.0826342279255,0.0826342279255,0.0826342279255,0.0845042481843,0.0816367489332,0.0682293329665,0.0659096585937,0.0580137428401,0.0521990775147,0.0580137428401,0.0580137428401,0.0580137428401,0.0580137428401,0.0568852181977,0.0492142946877,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935,0.0372967034935)
M_hpd_M95=c(1.63349258548, 1.63349258548,0.171079107269,0.171079107269,0.171079107269,0.171079107269,0.160442270732,0.158243926373,0.158243926373,0.158243926373,0.158243926373,0.158243926373,0.158243926373,0.158243926373,0.146943156227,0.141167377042,0.141167377042,0.141167377042,0.141167377042,0.141167377042,0.141167377042,0.141167377042,0.13998689622,0.137544818316,0.131869209314,0.123843467899,0.123843467899,0.123843467899,0.123843467899,0.123843467899,0.122933054783,0.122933054783,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938,0.114829180938)
R_hpd_m95=c(-1.39539691337, -1.39539691337,0.0302472105166,0.0302472105166,-0.0242654969454,-0.0631049712814,-0.076538991113,-0.076538991113,-0.076538991113,-0.076538991113,-0.076538991113,-0.076538991113,-0.076538991113,-0.076538991113,-0.0733102529153,-0.0650073879253,-0.058552206184,-0.042202833876,-0.0393890566444,-0.037112121902,-0.0391147775813,-0.0336927249669,-0.0276349437935,-0.0391147775813,-0.0391147775813,-0.026761681424,-0.026761681424,-0.026761681424,-0.026761681424,-0.0391147775813,-0.00130270191892,0.0618932125256,0.0618932125256,0.0618932125256,0.0618932125256,0.0345411413853,0.0345411413853,0.0345411413853,0.0345411413853,0.0305454108958,0.0305454108958,0.0305454108958,0.0305454108958,0.0305454108958,0.0305454108958,0.0305454108958,-0.00301979939155,-0.00301979939155,-0.00301979939155,-0.00301979939155,-0.00301979939155,-0.00301979939155)
R_hpd_M95=c(-0.590319617933, -0.590319617933,0.234532564735,0.234532564735,0.226889382528,0.203298834788,0.0308587021685,0.0142734258146,0.0142734258146,0.0142734258146,0.0142734258146,0.0142734258146,0.0142734258146,0.0162212800523,0.0302472105166,0.0431618639761,0.0590686562871,0.0644235688355,0.0674225318232,0.0725366661752,0.0644235688355,0.0782464263224,0.0930730973369,0.10497081673,0.10497081673,0.110462136701,0.110462136701,0.11768268075,0.11768268075,0.148415370532,0.295052066588,0.398191834904,0.398191834904,0.398191834904,0.387234041592,0.335399329462,0.335399329462,0.335399329462,0.335399329462,0.345343891578,0.345343891578,0.345343891578,0.345343891578,0.354883048831,0.345343891578,0.370804211305,0.336451901105,0.336451901105,0.336451901105,0.336451901105,0.336451901105,0.336451901105)
L_mean=c(0.270369071938, 0.270369071938,0.270369071938,0.270369071938,0.261216536275,0.193720861208,0.0966510490473,0.0946587809587,0.0946587809587,0.0946913902243,0.0946913902243,0.0949262990893,0.0949262990893,0.0959676733209,0.100653079864,0.107737385766,0.116955296171,0.124481585725,0.125927889516,0.12679791968,0.130025824044,0.133533124032,0.133533124032,0.133474954472,0.133800425189,0.134416932746,0.134416932746,0.135042403513,0.13614243798,0.143911745946,0.226890795166,0.307942590935,0.307942590935,0.307942590935,0.305717040195,0.287684868766,0.287547952617,0.286919185668,0.286272217945,0.285772759453,0.285262265835,0.285262265835,0.286136624077,0.287996771768,0.286051351618,0.287309759223,0.282582585911,0.280630784104,0.280630784104,0.280630784104,0.280630784104,0.280630784104)
M_mean=c(1.16286273887, 1.16286273887,0.129117986228,0.129117986228,0.129153402888,0.129222246118,0.125665020109,0.125297877398,0.125297877398,0.125297877398,0.125297877398,0.125201144365,0.125201144365,0.124999898485,0.119771429539,0.117280577448,0.117088095114,0.116762141162,0.116762141162,0.116762141162,0.116841889284,0.115760674338,0.109407562844,0.0989166724962,0.0952410724611,0.0937536220692,0.0933513080398,0.0933513080398,0.0930604997507,0.0930604997507,0.0922594392146,0.0904484138911,0.0864578647643,0.0862517610647,0.0862480416037,0.0857549926447,0.0857549926447,0.0859504893306,0.0859054568006,0.0857887624038,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127,0.0860030257127)
R_mean=c(-0.892493666933, -0.892493666933,0.14125108571,0.14125108571,0.132063133387,0.0644986150903,-0.0290139710612,-0.030639096439,-0.030639096439,-0.0306064871733,-0.0306064871733,-0.0302748452759,-0.0302748452759,-0.0290322251641,-0.0191183496755,-0.00954319168284,-0.000132798943342,0.00771944456285,0.00916574835443,0.0100357785182,0.01318393476,0.0177724496939,0.0241255611879,0.0345582819761,0.038559352728,0.0406633106772,0.0410656247066,0.0416910954728,0.0430819382298,0.0508512461953,0.134631355952,0.217494177044,0.221484726171,0.221690829871,0.219468998591,0.201929876121,0.201792959972,0.200968696338,0.200366761144,0.199983997049,0.199259240122,0.199259240122,0.200133598364,0.201993746055,0.200048325905,0.20130673351,0.196579560198,0.194627758391,0.194627758391,0.194627758391,0.194627758391,0.194627758391)
trans=0.5
age=(0:(52-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.500238760085), xlim = c(-54.6,2.6), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.79684184403), xlim = c(-54.6,2.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.53493660471, 0.438011018395), xlim = c(-54.6,2.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-54.6,2.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()